#!/bin/bash
###############################################################
# Script to perform a vulnerability scan using NUCLEI
###############################################################
# See https://nuclei.projectdiscovery.io/nuclei/get-started
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [URL]"
    echo ""
    echo "Call example:"
    echo "    $script_name https://righettod.eu"
    exit 1
fi
url="$1"
rate_limit=40
timeout=30
retries=5
echo -e "\e[93m[+] Scan site '$url' for CVE...\e[0m"
nuclei -silent -tags cve,cves -follow-redirects -rate-limit $rate_limit -concurrency $rate_limit -timeout $timeout -retries $retries -disable-update-check -u "$url"
echo -e "\e[93m[+] Scan site '$url' for others content...\e[0m"
nuclei -silent -exclude-id http-missing-security-headers -exclude-type dns,whois,ssl -follow-redirects -rate-limit $rate_limit -concurrency $rate_limit -timeout $timeout -retries $retries -disable-update-check -u "$url"
