#!/bin/bash
#######################################################################
# Script to perform different vulnerability scans against a Wordpress
#######################################################################
# See https://nuclei.projectdiscovery.io/nuclei/get-started
# See https://github.com/wpscanteam/wpscan
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [URL]"
    echo ""
    echo "Call example:"
    echo "    $script_name https://righettod.eu"
    exit 1
fi
url="$1"
req_timeout=30
echo -e "\e[93m[+] Scan with WPScan ...\e[0m"
wpscan --rua --no-update --no-banner --request-timeout $req_timeout --url "$url"
echo -e "\e[93m[+] Scan with Nuclei ...\e[0m"
nuclei -silent -tags wordpress -exclude-severity info -rate-limit 10 -concurrency 10 -timeout $req_timeout -retries 5 -disable-update-check -u "$url"
